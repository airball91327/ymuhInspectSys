@model InspectSystem.Models.InspectDocPrintVModel

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <style type="text/css">
        .style1 {
            width: 100%;
        }

        .style2 {
            width: 100%;
            font-size: 10pt;
        }

        .style3 {
            height: 30px;
            width: 125px;
        }

        .style4 {
            height: 30px;
            width: 75px;
            text-align: center;
        }

        .style5 {
            text-align: center;
            height: 25px;
        }

        .style6 {
            width: 100%;
        }

        @@media print {
            Footer {
                display: none !important;
            }
        }
    </style>
</head>
<body style="margin: 0px; font-family: DFKai-SB" onload='@*window.print(); setTimeout(window.close, 500);*@ '>
    <div>
        <table class="style1">
            <tr style="font-size:36px;">
                <td>
                    工務室值班交接紀錄表
                </td>
                <td align="right">
                    @{
                        var year = Model.ApplyDate.Year - 1911;
                        var month = Model.ApplyDate.Month;
                        var day = Model.ApplyDate.Day;
                    }
                    日期：@year 年 @month 月 @day 日
                </td>
            </tr>
        </table>
        <table cellpadding="0" cellspacing="0" class="style1">
            <tr>
                <td>
                    <table cellpadding="0" cellspacing="0" class="style2"
                           style="border: 4px solid #000000">
                        <tr style="font-size: 2em;">
                            <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                大夜班
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Engineer)
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="25%">
                                @Model.Shift3Engineer
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Checker)
                            </td>
                            <td colspan="4" align="center"
                                style="border-bottom-style: solid; border-bottom-width: 4px; border-right-style: solid; border-right-width: 4px; border-right-color: #000000; border-bottom-color: #000000">
                                @Model.Shift3Checker
                            </td>
                        </tr>

                        @if (Model.ShiftDetails2.Count() > 0)
                        {
                            var docClasses = Model.ShiftDetails2.GroupBy(d => d.ClassId).Select(x => x.FirstOrDefault()).ToList();
                            foreach (var docClass in docClasses.OrderBy(d => d.ClassOrder))
                            {
                                <tr style="font-size: 2em;">
                                    <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                        width="15%">
                                        @docClass.ClassName
                                    </td>
                                    @{
                                        var docItems = Model.ShiftDetails2.Where(d => d.ClassId == docClass.ClassId)
                                                                          .GroupBy(d => d.ItemId).Select(x => x.FirstOrDefault());
                                        foreach (var docItem in docItems.OrderBy(d => d.ItemOrder))
                                        {
                                            <td class="style5"
                                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                                width="15%">
                                                @docItem.ItemName
                                            </td>
                                            var docFields = Model.ShiftDetails2.Where(d => d.ClassId == docItem.ClassId && d.ItemId == docItem.ItemId);
                                            int count = 0;
                                            foreach (var field in docFields)
                                            {
                                                <td colspan="6">
                                                    <table style="width: 100%;">
                                                        <tr>
                                                            <td class="style5"
                                                                style="border-right-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center">
                                                                欄位
                                                            </td>
                                                            <td class="style5"
                                                                style="border-right-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center">
                                                                數值
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </td>
                                            }

                                        }
                                    }

                                </tr>
                            }
                        }

                        <tr style="font-size: 2em; height: 150px;">
                            <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Note)
                            </td>
                            <td colspan="7" align="left"
                                style="border-bottom-style: solid; border-bottom-width: 4px; border-right-style: solid; border-right-width: 4px; border-right-color: #000000; border-bottom-color: #000000">
                                @Model.Shift3Note
                            </td>
                        </tr>

                        <!--白天班-->
                        <tr style="font-size: 2em;">
                            <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                白天班
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Engineer)
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="25%">
                                @Model.Shift1Engineer
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Checker)
                            </td>
                            <td colspan="4" align="center"
                                style="border-bottom-style: solid; border-bottom-width: 4px; border-right-style: solid; border-right-width: 4px; border-right-color: #000000; border-bottom-color: #000000">
                                @Model.Shift1Checker
                            </td>
                        </tr>

                        @if (Model.ShiftDetails1.Count() > 0)
                        {
                            <tr style="font-size: 2em;">
                                <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                    width="15%">
                                    類別
                                </td>
                                <td class="style5"
                                    style="border-right-style: solid; border-bottom-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                    width="15%">
                                    項目
                                </td>
                                <td colspan="6">
                                    <table style="width: 100%;">
                                        <tr>
                                            <td class="style5"
                                                style="border-right-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center">
                                                欄位
                                            </td>
                                            <td class="style5"
                                                style="border-right-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center">
                                                數值
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        }

                        <tr style="font-size: 2em; height: 150px;">
                            <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Note)
                            </td>
                            <td colspan="7" align="left"
                                style="border-bottom-style: solid; border-bottom-width: 4px; border-right-style: solid; border-right-width: 4px; border-right-color: #000000; border-bottom-color: #000000">
                                @Model.Shift1Note
                            </td>
                        </tr>
                        <!--小夜班-->
                        <tr style="font-size: 2em;">
                            <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                小夜班
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Engineer)
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="25%">
                                @Model.Shift2Engineer
                            </td>
                            <td class="style5"
                                style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Checker)
                            </td>
                            <td colspan="4" align="center"
                                style="border-bottom-style: solid; border-bottom-width: 4px; border-right-style: solid; border-right-width: 4px; border-right-color: #000000; border-bottom-color: #000000">
                                @Model.Shift2Checker
                            </td>
                        </tr>

                        @if (Model.ShiftDetails2.Count() > 0)
                        {
                            <tr style="font-size: 2em;">
                                <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                    width="15%">
                                    類別
                                </td>
                                <td class="style5"
                                    style="border-right-style: solid; border-bottom-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                    width="15%">
                                    項目
                                </td>
                                <td colspan="6">
                                    <table style="width: 100%;">
                                        <tr>
                                            <td class="style5"
                                                style="border-right-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center">
                                                欄位
                                            </td>
                                            <td class="style5"
                                                style="border-right-style: solid; border-right-width: 2px; border-bottom-width: 2px; border-right-color: #000000; border-bottom-color: #000000; text-align: center">
                                                數值
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        }

                        <tr style="font-size: 2em; height: 150px;">
                            <td style="border-right-style: solid; border-bottom-style: solid; border-right-width: 4px; border-bottom-width: 4px; border-right-color: #000000; border-bottom-color: #000000; text-align: center"
                                width="15%">
                                @Html.DisplayNameFor(model => model.Shift1Note)
                            </td>
                            <td colspan="7" align="left"
                                style="border-bottom-style: solid; border-bottom-width: 1px; border-right-style: solid; border-right-width: 1px; border-right-color: #000000; border-bottom-color: #000000">
                                @Model.Shift2Note
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>

        </table>
        <table class="style1" style="table-layout:fixed;">
            <tr style="font-size:36px;">
                <td align="left">
                    工務組長：
                </td>
                <td align="left">
                </td>
                <td align="left">
                    單位主管：
                </td>
                <td align="left">
                </td>
            </tr>
        </table>
    </div>

</body>
</html>
